# response_handler.py
from typing import Dict, Any, Optional
import re
from .prompts import SYSTEM_PROMPT

class ResponseHandler:
    def _handle_general_questions(self, user_query: str) -> Optional[str]:
        query_lower = user_query.lower()
        
        general_questions = {
            'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚': 'ĞŸÑ€Ğ¸Ğ²ĞµÑ‚! Ğ¯ Ğ­Ğ¹Ñ‡Ğ°Ñ€Ğ¸Ğº - AI Ğ°ÑÑĞ¸ÑÑ‚ĞµĞ½Ñ‚ Ğ´Ğ»Ñ HR Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸ ğŸ’¡\n\nĞ§ĞµĞ¼ Ğ¼Ğ¾Ğ³Ñƒ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‡ÑŒ?',
            'hello': 'Hello! I am HR Assistant - AI for HR analytics ğŸ’¡\n\nHow can I help you?',
            'hi': 'Hi! I am HR Assistant ğŸ’¡\n\nWhat would you like to know?',
            'Ñ‡Ñ‚Ğ¾ Ñ‚Ñ‹ ÑƒĞ¼ĞµĞµÑˆÑŒ': self._get_capabilities_text(),
            'Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰ÑŒ': self._get_help_text(),
            'ĞºĞ°Ğº Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒÑÑ': self._get_help_text(),
            'ÑĞ¿Ñ€Ğ°Ğ²ĞºĞ°': self._get_help_text(),
            'Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸': self._get_capabilities_text(),
            'help': self._get_help_text(),
            'capabilities': self._get_capabilities_text(),
            'ĞºĞ°ĞºĞ¸Ğµ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹': self._get_help_examples(),
            'Ñ‡Ñ‚Ğ¾ ÑĞ¿Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ': self._get_help_examples(),
            'Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²': self._get_help_examples(),
        }
        
        for keyword, response in general_questions.items():
            if keyword in query_lower:
                return response
        
        return None

    def _handle_empty_response(self, category: str, user_query: str, command: Dict) -> str:
        templates = {
            "unknown_service": f"""ğŸ” ĞĞµ Ğ½Ğ°ÑˆĞµĞ» Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ½Ğ¾Ğ¼Ñƒ ÑĞµÑ€Ğ²Ğ¸ÑÑƒ: "{user_query}"

ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ñ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğ¼ ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ¼:
â€¢ Ğ§Ğ¸ÑĞ»ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ Ğ² ÑĞµÑ€Ğ²Ğ¸ÑĞµ Ğ¢Ğ°ĞºÑĞ¸
â€¢ Ğ¢ĞµĞºÑƒÑ‡ĞµÑÑ‚ÑŒ Ğ² ĞœĞ°Ñ€ĞºĞµÑ‚Ğµ
â€¢ Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ¾ ĞĞ±Ğ»Ğ°ĞºÑƒ

ğŸ“‹ Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğµ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹: Ğ¢Ğ°ĞºÑĞ¸, ĞœĞ°Ñ€ĞºĞµÑ‚, ĞšÑ€Ğ°ÑƒĞ´, Ğ›Ğ°Ğ²ĞºĞ°, Ğ¤Ğ¸Ğ½Ñ‚ĞµÑ…, Ğ•Ğ´Ğ°, Ğ”Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞ°, ĞĞ±Ğ»Ğ°ĞºĞ¾""",
            
            "insufficient_risk_data": f"""ğŸ“Š Ğ”Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ñ€Ğ¸ÑĞºĞ¾Ğ² Ğ² ÑÑ‚Ğ¾Ğ¼ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞµ Ğ½ĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…: "{user_query}"

ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ:
â€¢ ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ñ€Ğ¸ÑĞºĞ¾Ğ² ÑƒĞ²Ğ¾Ğ»ÑŒĞ½ĞµĞ½Ğ¸Ñ Ğ² Ğ¢Ğ°ĞºÑĞ¸
â€¢ Ğ“Ñ€ÑƒĞ¿Ğ¿Ñ‹ Ñ€Ğ¸ÑĞºĞ° Ğ¿Ğ¾ Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚Ñƒ Ğ² ĞœĞ°Ñ€ĞºĞµÑ‚Ğµ
â€¢ ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ½Ñ‹Ğµ Ğ·Ğ¾Ğ½Ñ‹ Ğ¿Ğ¾ Ñ‚ĞµĞºÑƒÑ‡ĞµÑÑ‚Ğ¸

ğŸ’¡ Ğ£ĞºĞ°Ğ¶Ğ¸Ñ‚Ğµ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğ¹ ÑĞµÑ€Ğ²Ğ¸Ñ Ğ´Ğ»Ñ Ğ±Ğ¾Ğ»ĞµĞµ Ñ‚Ğ¾Ñ‡Ğ½Ğ¾Ğ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°""",
            
            "feature_unavailable": f"""ğŸš§ Ğ­Ñ‚Ğ° Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾ Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ°: "{user_query}"

Ğ’Ğ¼ĞµÑÑ‚Ğ¾ ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ:
â€¢ Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸ Ñ‚ĞµĞºÑƒÑ‡ĞµÑÑ‚ÑŒ Ğ¿Ğ¾ ÑĞµÑ€Ğ²Ğ¸ÑĞ°Ğ¼ 
â€¢ Ğ¢Ğ¾Ğ¿ Ğ¾Ñ‚Ğ´ĞµĞ»Ğ¾Ğ² Ğ¿Ğ¾ Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸
â€¢ Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸ĞºĞ° Ğ½Ğ°Ğ¹Ğ¼Ğ¾Ğ² Ğ·Ğ° Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ Ğ¼ĞµÑÑÑ†Ñ‹

ğŸ“ˆ Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¸ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ""",
            
            "no_data_general": f"""ğŸ“­ ĞŸĞ¾ Ğ²Ğ°ÑˆĞµĞ¼Ñƒ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑƒ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…: "{user_query}"

Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾, Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ñ‹ ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ ÑÑ‚Ñ€Ğ¾Ğ³Ğ¸Ğµ Ğ¸Ğ»Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒÑÑ‚.

ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ:
â€¢ Ğ§Ğ¸ÑĞ»ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ Ğ² ÑĞµÑ€Ğ²Ğ¸ÑĞµ Ğ¢Ğ°ĞºÑĞ¸
â€¢ ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¶ĞµĞ½Ñ‰Ğ¸Ğ½ Ğ² ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸
â€¢ Ğ Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ Ğ¿Ğ¾Ğ»Ñƒ

ğŸ’¬ Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ Ğ±Ğ¾Ğ»ĞµĞµ Ğ¾Ğ±Ñ‰Ğ¸Ğµ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹""",
            
            "missing_metric": f"""ğŸ¯ ĞĞµ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ° Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ° Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ğ² Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞµ: "{user_query}"

Ğ£Ñ‚Ğ¾Ñ‡Ğ½Ğ¸Ñ‚Ğµ, Ñ‡Ñ‚Ğ¾ Ğ¸Ğ¼ĞµĞ½Ğ½Ğ¾ Ñ…Ğ¾Ñ‚Ğ¸Ñ‚Ğµ ÑƒĞ·Ğ½Ğ°Ñ‚ÑŒ:
â€¢ Ğ§Ğ¸ÑĞ»ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ Ğ² ÑĞµÑ€Ğ²Ğ¸ÑĞµ Ğ¢Ğ°ĞºÑĞ¸
â€¢ Ğ¢ĞµĞºÑƒÑ‡ĞµÑÑ‚ÑŒ Ğ² ĞœĞ°Ñ€ĞºĞµÑ‚Ğµ
â€¢ Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹ Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚ Ğ² ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸

ğŸ“Š Ğ£ĞºĞ°Ğ¶Ğ¸Ñ‚Ğµ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½ÑƒÑ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºÑƒ""",
            
            "missing_column": f"""ğŸ“‹ ĞĞµ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ° ĞºĞ¾Ğ»Ğ¾Ğ½ĞºĞ° Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ğ² Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞµ: "{user_query}"

Ğ£Ñ‚Ğ¾Ñ‡Ğ½Ğ¸Ñ‚Ğµ, Ğ¿Ğ¾ ĞºĞ°ĞºĞ¾Ğ¼Ñƒ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñƒ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ:
â€¢ Ğ Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ ÑĞµÑ€Ğ²Ğ¸ÑĞ°Ğ¼
â€¢ Ğ Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚Ñƒ 
â€¢ Ğ Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ Ğ¾Ğ¿Ñ‹Ñ‚Ñƒ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹

ğŸ—‚ï¸ Ğ£ĞºĞ°Ğ¶Ğ¸Ñ‚Ğµ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°""",
            
            "unknown_column": self._handle_unknown_query(user_query),
            "unsupported_method": self._handle_unknown_query(user_query),
            "unsupported_metric": self._handle_unknown_query(user_query),
            "other_error": self._handle_unknown_query(user_query)
        }
        return templates.get(category, self._handle_unknown_query(user_query))

    def _get_capabilities_text(self) -> str:
        return """ğŸ’¡ Ğ§Ñ‚Ğ¾ Ñ ÑƒĞ¼ĞµÑ:

ğŸ“Š Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°:
â€¢ Ğ§Ğ¸ÑĞ»ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ Ğ² ÑĞµÑ€Ğ²Ğ¸ÑĞµ Ğ¢Ğ°ĞºÑĞ¸
â€¢ ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¶ĞµĞ½Ñ‰Ğ¸Ğ½ Ğ¸ Ğ¼ÑƒĞ¶Ñ‡Ğ¸Ğ½ Ğ² ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸  
â€¢ Ğ Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ Ğ¿Ğ¾Ğ»Ñƒ Ğ¸ Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚Ñƒ

ğŸ’° ĞĞ½Ğ°Ğ»Ğ¸Ğ· ÑÑ‚Ğ°Ğ²Ğ¾Ğº Ğ¸ Ğ¾Ğ¿Ñ‹Ñ‚Ğ°:
â€¢ Ğ”Ğ¾Ğ»Ñ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ñ… ÑÑ‚Ğ°Ğ²Ğ¾Ğº Ğ² ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸
â€¢ Ğ¡Ğ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸ĞºĞ¸ Ñ Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğ¼ Ğ±Ğ¾Ğ»ĞµĞµ 10 Ğ»ĞµÑ‚
â€¢ ĞĞ¿Ñ‹Ñ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ğ¿Ğ¾ Ğ¾Ñ‚Ğ´ĞµĞ»Ğ°Ğ¼

ğŸ‘¥ Ğ£Ğ³Ğ»ÑƒĞ±Ğ»ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·:
â€¢ Ğ¡Ğ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸ĞºĞ¸ Ğ´Ğ¾ 23 Ğ»ĞµÑ‚ Ğ² Ğ¢Ğ°ĞºÑĞ¸
â€¢ Ğ–ĞµĞ½Ñ‰Ğ¸Ğ½Ñ‹ Ñ Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğ¼ Ğ±Ğ¾Ğ»ĞµĞµ 5 Ğ»ĞµÑ‚
â€¢ Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ñ‰Ğ¸ĞºĞ¸ Ğ² ĞšÑ€Ğ°ÑƒĞ´Ğµ

ğŸ“ˆ Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ñ‹:
â€¢ Ğ¢Ğ¾Ğ¿-5 ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ² Ğ¿Ğ¾ Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸
â€¢ Ğ¢Ñ€ĞµĞ½Ğ´ Ğ½Ğ°Ğ¹Ğ¼Ğ¾Ğ² Ğ¸ ÑƒĞ²Ğ¾Ğ»ÑŒĞ½ĞµĞ½Ğ¸Ğ¹
â€¢ Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº Ğ¿Ğ¾ ÑĞµÑ€Ğ²Ğ¸ÑĞ°Ğ¼"""

    def _get_help_text(self) -> str:
        return """ğŸ’¡ ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ÑÑ‚Ğ¸ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹:

ğŸ”¢ Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹:
â€¢ Ğ§Ğ¸ÑĞ»ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ Ğ² ÑĞµÑ€Ğ²Ğ¸ÑĞµ Ğ¢Ğ°ĞºÑĞ¸
â€¢ ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¶ĞµĞ½Ñ‰Ğ¸Ğ½ Ğ² ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸
â€¢ Ğ Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ Ğ¿Ğ¾Ğ»Ñƒ

ğŸ“ˆ ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°:
â€¢ Ğ¢Ğ¾Ğ¿-5 ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ² Ğ¿Ğ¾ Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸  
â€¢ Ğ¢Ñ€ĞµĞ½Ğ´ Ğ½Ğ°Ğ¹Ğ¼Ğ¾Ğ²
â€¢ Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸ Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¿Ğ¾ ÑĞµÑ€Ğ²Ğ¸ÑĞ°Ğ¼

ğŸ¯ Ğ£Ğ³Ğ»ÑƒĞ±Ğ»ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·:
â€¢ Ğ¡Ğ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸ĞºĞ¸ Ğ´Ğ¾ 23 Ğ»ĞµÑ‚ Ğ² Ğ¢Ğ°ĞºÑĞ¸
â€¢ Ğ–ĞµĞ½Ñ‰Ğ¸Ğ½Ñ‹ Ñ Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğ¼ Ğ±Ğ¾Ğ»ĞµĞµ 5 Ğ»ĞµÑ‚
â€¢ Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ñ‰Ğ¸ĞºĞ¸ Ğ² ĞšÑ€Ğ°ÑƒĞ´Ğµ

âš ï¸ Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ°Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°:
â€¢ Ğ¡ĞºĞ¾Ğ»ÑŒĞºĞ¾ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ½Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ‚ÑŒ Ğ² Ğ¢Ğ°ĞºÑĞ¸?
â€¢ ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ñ€Ğ¸ÑĞºĞ¾Ğ² ÑƒĞ²Ğ¾Ğ»ÑŒĞ½ĞµĞ½Ğ¸Ñ Ğ² ĞœĞ°Ñ€ĞºĞµÑ‚Ğµ
â€¢ Ğ“Ğ´Ğµ ÑĞ°Ğ¼Ğ°Ñ Ğ²Ñ‹ÑĞ¾ĞºĞ°Ñ Ñ‚ĞµĞºÑƒÑ‡ĞµÑÑ‚ÑŒ?"""

    def _get_help_examples(self) -> str:
        return """â“ ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²:

ğŸ‘¥ ĞŸĞ¾ ÑĞ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸ĞºĞ°Ğ¼:
â€¢ Ğ§Ğ¸ÑĞ»ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ Ğ² ÑĞµÑ€Ğ²Ğ¸ÑĞµ Ğ¢Ğ°ĞºÑĞ¸
â€¢ ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¶ĞµĞ½Ñ‰Ğ¸Ğ½ Ğ² ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸  
â€¢ Ğ¡ĞºĞ¾Ğ»ÑŒĞºĞ¾ ÑƒĞ´Ğ°Ğ»Ñ‘Ğ½Ñ‰Ğ¸ĞºĞ¾Ğ² Ğ² ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸?

ğŸ“Š ĞŸĞ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞµ:
â€¢ Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ¾ Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚Ğ½Ñ‹Ğ¼ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸ÑĞ¼
â€¢ Ğ Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ Ğ¾Ğ¿Ñ‹Ñ‚Ñƒ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹  
â€¢ Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹ Ğ¾Ğ¿Ñ‹Ñ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ğ² ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸

ğŸ† Ğ¢Ğ¾Ğ¿-Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹:
â€¢ Ğ¢Ğ¾Ğ¿-5 ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ² Ğ¿Ğ¾ Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸
â€¢ Ğ¢Ğ¾Ğ¿-10 Ğ»Ğ¾ĞºĞ°Ñ†Ğ¸Ğ¹ Ğ¿Ğ¾ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ñƒ ÑĞ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸ĞºĞ¾Ğ²
â€¢ Ğ¡Ğ°Ğ¼Ñ‹Ğµ ĞºÑ€ÑƒĞ¿Ğ½Ñ‹Ğµ ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ñ‹

ğŸ“ˆ Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸ĞºĞ°:
â€¢ Ğ¢Ñ€ĞµĞ½Ğ´ Ğ½Ğ°Ğ¹Ğ¼Ğ¾Ğ²
â€¢ Ğ£Ğ²Ğ¾Ğ»ÑŒĞ½ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾ ÑĞµÑ€Ğ²Ğ¸ÑĞ°Ğ¼ Ğ¿Ğ¾ Ğ¼ĞµÑÑÑ†Ğ°Ğ¼
â€¢ Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸ ÑƒĞ²Ğ¾Ğ»ÑŒĞ½ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾ Ğ»Ğ¾ĞºĞ°Ñ†Ğ¸ÑĞ¼

ğŸ¯ Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·:
â€¢ Ğ¡ĞºĞ¾Ğ»ÑŒĞºĞ¾ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ½Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ‚ÑŒ Ğ² Ğ¢Ğ°ĞºÑĞ¸?
â€¢ ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ñ€Ğ¸ÑĞºĞ¾Ğ² ÑƒĞ²Ğ¾Ğ»ÑŒĞ½ĞµĞ½Ğ¸Ñ Ğ² ĞœĞ°Ñ€ĞºĞµÑ‚Ğµ
â€¢ Ğ“Ğ´Ğµ ÑĞ°Ğ¼Ğ°Ñ Ğ²Ñ‹ÑĞ¾ĞºĞ°Ñ Ñ‚ĞµĞºÑƒÑ‡ĞµÑÑ‚ÑŒ?"""

    def _handle_complex_query(self, user_query: str) -> str:
        return f"""ğŸ¤” Ğ­Ñ‚Ğ¾ Ğ¸Ğ½Ñ‚ĞµÑ€ĞµÑĞ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ²Ğ¾Ğ¿Ñ€Ğ¾Ñ: "{user_query}"

Ğ¡ĞµĞ¹Ñ‡Ğ°Ñ Ñ ÑƒĞ¼ĞµÑ Ğ¾Ñ‚Ğ²ĞµÑ‡Ğ°Ñ‚ÑŒ Ğ½Ğ° ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹:

ğŸ’° ĞĞ½Ğ°Ğ»Ğ¸Ğ· ÑÑ‚Ğ°Ğ²Ğ¾Ğº:
â€¢ Ğ”Ğ¾Ğ»Ñ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ñ… ÑÑ‚Ğ°Ğ²Ğ¾Ğº Ğ² ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸
â€¢ Ğ¡Ğ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸ĞºĞ¸ Ñ Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğ¼ Ğ±Ğ¾Ğ»ĞµĞµ 10 Ğ»ĞµÑ‚
â€¢ ĞĞ¿Ñ‹Ñ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ğ¿Ğ¾ Ğ¾Ñ‚Ğ´ĞµĞ»Ğ°Ğ¼

ğŸ‘¥ Ğ£Ğ³Ğ»ÑƒĞ±Ğ»ĞµĞ½Ğ½Ğ°Ñ Ğ´ĞµĞ¼Ğ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ:
â€¢ Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚Ñƒ Ğ¸ Ğ¾Ğ¿Ñ‹Ñ‚Ñƒ
â€¢ ĞĞ½Ğ°Ğ»Ğ¸Ğ· ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ½Ñ‹Ñ… ÑĞ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸ĞºĞ¾Ğ²  
â€¢ ĞšĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ñ

ğŸ“Š Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°:
â€¢ ĞŸĞ¾Ğ´ÑÑ‡ĞµÑ‚ ÑĞ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸ĞºĞ¾Ğ² Ğ¿Ğ¾ Ğ¾Ñ‚Ğ´ĞµĞ»Ğ°Ğ¼/ÑĞµÑ€Ğ²Ğ¸ÑĞ°Ğ¼
â€¢ Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ¾ Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚Ñƒ, Ğ¾Ğ¿Ñ‹Ñ‚Ñƒ, Ğ¿Ğ¾Ğ»Ñƒ  
â€¢ Ğ¢Ğ¾Ğ¿-20 ÑĞ¿Ğ¸ÑĞºĞ¸ Ğ¿Ğ¾ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğ¼ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ°Ğ¼
â€¢ Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ (Ñ‚ĞµĞºÑƒÑ‡ĞµÑÑ‚ÑŒ, Ğ½Ğ°Ğ¹Ğ¼Ñ‹)

Ğ¡Ğ»Ğ¾Ğ¶Ğ½ÑƒÑ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºÑƒ (ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ, Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ·Ñ‹, Ğ¿Ñ€Ğ¸Ñ‡Ğ¸Ğ½Ğ½Ğ¾-ÑĞ»ĞµĞ´ÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·) Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»Ñ Ğ² Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞ¼! ğŸ“ˆ

ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‚ÑŒ Ğ²Ğ¾Ğ¿Ñ€Ğ¾Ñ Ğ¿Ñ€Ğ¾ Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ, Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€:
â€¢ "Ğ¡ĞºĞ¾Ğ»ÑŒĞºĞ¾ ÑĞ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸ĞºĞ¾Ğ² Ğ½Ğ° 0.5 ÑÑ‚Ğ°Ğ²ĞºĞ¸?"
â€¢ "Ğ Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ ÑÑ‚Ğ°Ğ²ĞºĞ°Ğ¼"
â€¢ "Ğ¡Ğ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸ĞºĞ¸ Ñ Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğ¼ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ 2 Ğ»ĞµÑ‚"
â€¢ "ĞœĞ¾Ğ»Ğ¾Ğ´Ñ‹Ğµ ÑĞ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸ĞºĞ¸ Ğ² Ğ¢Ğ°ĞºÑĞ¸" """

    def _handle_unknown_query(self, user_query: str) -> str:
        return f"""ĞĞµ ÑĞ¾Ğ²ÑĞµĞ¼ Ğ¿Ğ¾Ğ½ÑĞ» Ğ²Ğ°Ñˆ Ğ²Ğ¾Ğ¿Ñ€Ğ¾Ñ ğŸ¤” "{user_query}"

ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ¾Ğ´Ğ¸Ğ½ Ğ¸Ğ· ÑÑ‚Ğ¸Ñ… Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²:

ğŸ‘¥ Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ:
â€¢ Ğ§Ğ¸ÑĞ»ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ Ğ² ÑĞµÑ€Ğ²Ğ¸ÑĞµ Ğ¢Ğ°ĞºÑĞ¸
â€¢ ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¶ĞµĞ½Ñ‰Ğ¸Ğ½ Ğ² ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸
â€¢ Ğ Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ Ğ¿Ğ¾Ğ»Ñƒ

ğŸ“Š ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°:  
â€¢ Ğ¢Ğ¾Ğ¿-5 ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ² Ğ¿Ğ¾ Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸
â€¢ Ğ¢Ñ€ĞµĞ½Ğ´ Ğ½Ğ°Ğ¹Ğ¼Ğ¾Ğ²
â€¢ Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸ Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¿Ğ¾ ÑĞµÑ€Ğ²Ğ¸ÑĞ°Ğ¼

ğŸ¯ Ğ£Ğ³Ğ»ÑƒĞ±Ğ»ĞµĞ½Ğ½Ñ‹Ğµ:
â€¢ Ğ¡Ğ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸ĞºĞ¸ Ğ´Ğ¾ 23 Ğ»ĞµÑ‚ Ğ² Ğ¢Ğ°ĞºÑĞ¸
â€¢ Ğ–ĞµĞ½Ñ‰Ğ¸Ğ½Ñ‹ Ñ Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğ¼ Ğ±Ğ¾Ğ»ĞµĞµ 5 Ğ»ĞµÑ‚
â€¢ Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ñ‰Ğ¸ĞºĞ¸ Ğ² ĞšÑ€Ğ°ÑƒĞ´Ğµ

ğŸ’¡ Ğ£Ğ·Ğ½Ğ°Ñ‚ÑŒ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ:
â€¢ Ğ§Ñ‚Ğ¾ Ñ‚Ñ‹ ÑƒĞ¼ĞµĞµÑˆÑŒ?"""

    def _format_final_answer(self, user_query: str, tool_result: str, command: Dict[str, Any]) -> str:
        return tool_result